#!/bin/bash

# Use neovim for vim if present
command -v nvim >/dev/null && alias vim="nvim" vimdiff="nvim -d"
command -v neomutt >/dev/null && alias mutt="neomutt"
alias slack="weechat"

# ls and other file stuff
alias ls='ls -hN --color=auto --group-directories-first'
alias l='exa -bghl -sname'
alias ll='exa -bghla -sname'
alias tree='exa --tree'
alias grep='grep --color=auto'
alias diff='diff --color=auto'
alias mkd='mkdir -pv'

# UNI
alias uni="cd /mnt/external/Google\ Drive/Uni/6.\ Semester"

# System
alias p='sudo pacman'
alias mirr='sudo pacman-mirrors --fasttrack && p -Syyu'
alias SS='sudo systemctl'
alias startx='startx ~/.xinitrc'

# Other
alias wiki='nvim -c "VimwikiIndex"'
alias time='command time'
alias ka='killall'
alias df='df -kHT'
alias del='trash'
alias f='nnn'
alias g='git'
alias e='$EDITOR'
alias v='$EDITOR'
alias x='sxiv -ft *'
alias sdn='sudo shutdown -h now'
alias ccat='highlight --out-format=ansi --force'
alias lsp='pacman -Qett --color=always | less'
alias ffmpeg='ffmpeg -hide_banner'
alias scim="sc-im"
alias marvin="ssh hausersn@marvin.informatik.uni-stuttgart.de"
alias ru="sudo docker run -ti --rm ubuntu:latest bash"
alias cvpn="sudo openvpn --config ~/docs/conni.ovpn"

# Shortcuts
## Files
alias eA='vim ~/.aliasrc'
alias eB='vim ~/.bashrc'
alias eD='vim ~/.dwm.config.h'
alias eG='vim ~/.gitconfig'
alias eI='vim ~/.config/i3/config'
alias eIB='vim ~/.config/i3blocks/config'
alias eM='vim ~/.config/mutt/muttrc'
alias eN='vim ~/.config/newsboat/config'
alias eP='vim ~/.config/polybar/config'
alias eU='vim ~/.config/newsboat/urls'
alias eV='vim ~/.config/nvim/init.vim'
alias eZ='vim ~/.zshrc'
alias eZP='vim ~/.zprofile'

## Directories
alias h='cd ~/'
alias d='cd ~/docs'
alias D='cd ~/Downloads'
alias sc='cd ~/bin/scripts'
alias cf='cd ~/.config'
alias dot='cd ~/repos/dotfiles'
alias mn='cd /mnt'

shdl() { curl -O $(curl -s http://sci-hub.tw/"$@" | grep location.href | grep -o http.*pdf) ; }
se() { du -a ~/bin/* | awk '{print $2}' | fzf | xargs -r $EDITOR ; }
vf() { fzf --bind ctrl-k:preview-up,shift-up:preview-up,ctrl-j:preview-down,shift-down:preview-down --preview='highlight --out-format=ansi --force {} | nl -ba' | xargs -r -I % $EDITOR % ; }
fh() { print -z $( ([ -n "$ZSH_NAME" ] && fc -l 1 || history) | fzf +s --tac | sed 's/ *[0-9]* *//' ) ; }

declare -a DIRS

savedir() {
  local i
  for ((i=1;i<=9;i++)); do
    test "$1" = "${DIRS[$i]}" && return
  done
  for ((i=9;i>1;i--)); do
    DIRS[$i]="${DIRS[((i-1))]}"
  done
  DIRS[1]="$1"
}

showdirs() {
  local i=1
  while [ "${DIRS[$i]}" ]; do
    echo "$i: ${DIRS[$i]}"
    ((i++))
  done
}

gotodir() {
  local d
  showdirs
  printf "goto: "
  read -n 1 d
  echo
  cd "${DIRS[$d]}"
}

PROMPT_COMMAND=prompt_command
prompt_command() { savedir "$OLDPWD"; }

alias cdh=gotodir
