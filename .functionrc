#!/bin/bash

shdl() { curl -O $(curl -s http://sci-hub.tw/"$@" | grep location.href | grep -o http.*pdf) ; }
se() { du -a ~/bin/* | awk '{print $2}' | fzf | xargs -r $EDITOR ; }
vf() { fzf --bind ctrl-k:preview-up,shift-up:preview-up,ctrl-j:preview-down,shift-down:preview-down --preview='highlight --out-format=ansi --force {} | nl -ba' | xargs -r -I % $EDITOR % ; }
writecmd (){ perl -e 'ioctl STDOUT, 0x5412, $_ for split //, do{ chomp($_ = <>); $_ }' ; }
fh(){([ -n "$ZSH_NAME" ] && fc -l 1 || history) | fzf +s --tac | sed -re 's/^\s*[0-9]+\s*//' | writecmd ; }

declare -a DIRS

savedir()
{
	local i
	for ((i=1;i<=9;i++)); do
		test "$1" = "${DIRS[$i]}" && return
	done
	for ((i=9;i>1;i--)); do
		DIRS[$i]="${DIRS[((i-1))]}"
	done
	DIRS[1]="$1"
}

showdirs()
{
	local i=1
	while [ "${DIRS[$i]}" ]; do
		echo "$i: ${DIRS[$i]}"
		((i++))
	done
}

gotodir()
{
	local d
	showdirs
	printf "goto: "
	read -n 1 d
	echo
	cd "${DIRS[$d]}"
}

PROMPT_COMMAND=prompt_command
prompt_command() { savedir "$OLDPWD"; }

alias cdh=gotodir
