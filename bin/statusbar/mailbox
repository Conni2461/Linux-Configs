#!/bin/sh

# i3blocks mail module.
# Displays number of unread mail and an loading icon if updating.
# When clicked, brings up `neomutt`.

case $BLOCK_BUTTON in
        1)      "$TERMINAL" -n 'floatt' -e neomutt &
                sleep 0.1
                i3-msg '[instance="floatt"] move position center' >/dev/null ;;
        2)      setsid $HOME/.config/mutt/etc/mailsync.sh >/dev/null & ;;
        3)      pgrep -x dunst >/dev/null && notify-send "<b>ğŸ“¬ Mail module:</b>
- Shows unread mail
- Shows ğŸ”ƒ if syncing mail
- Left click opens neomutt
- Middle click syncs mail" ;;
esac

echo "$(du -a ~/.local/share/mail/*/{INBOX,Inbox}/new/* 2>/dev/null | sed -n '$=')$(cat /tmp/imapsyncicon_$USER 2>/dev/null)"
