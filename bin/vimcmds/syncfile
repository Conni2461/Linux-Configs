#!/bin/sh

shared=/home/conni/docs/shared
fpath=$(dirname "${1}")
epath=${fpath#"$shared"}
fname=$(basename "${1}")

run()
{
	ping -q -t 1 -c 1 $(ip r | grep -m 1 default | cut -d ' ' -f 3) >/dev/null || exit

	if [ "${epath}" != "" ]; then
		ssh home mkdir -vp /home/pi/docs/shared"${epath}"/
	fi

	scp "${1}" home:~/docs/shared"${epath}"/
	notify-send "Synced ${fname}"
}

case "${fpath}" in
	"${shared}"* ) run "${1}" & ;;
esac
